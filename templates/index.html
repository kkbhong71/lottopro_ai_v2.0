{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center min-vh-100">
            <div class="col-lg-6">
                <div class="hero-content">
                    <h1 class="display-4 fw-bold text-white mb-4">
                        ğŸ¯ AIê°€ ì˜ˆì¸¡í•˜ëŠ”<br>
                        <span class="text-warning">ë¡œë˜ ë‹¹ì²¨ë²ˆí˜¸</span>
                        <span class="badge bg-success ms-2">v2.0</span>
                    </h1>
                    <p class="lead text-white-50 mb-4">
                        5ê°€ì§€ ë…ìì ì¸ AI ëª¨ë¸ì´ ê³¼ê±° ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ 
                        ìµœì ì˜ ë¡œë˜ ì˜ˆìƒë²ˆí˜¸ë¥¼ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤.
                    </p>
                    <div class="hero-stats row text-center mb-4">
                        <div class="col-3">
                            <div class="stat-item">
                                <h3 class="text-warning">5</h3>
                                <small class="text-white-50">AI ëª¨ë¸</small>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="stat-item">
                                <h3 class="text-warning">1185</h3>
                                <small class="text-white-50">ë¶„ì„ íšŒì°¨</small>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="stat-item">
                                <h3 class="text-warning">15+</h3>
                                <small class="text-white-50">ì‹ ê¸°ëŠ¥</small>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="stat-item">
                                <h3 class="text-warning">FREE</h3>
                                <small class="text-white-50">ì™„ì „ ë¬´ë£Œ</small>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex gap-2 flex-wrap">
                        <a href="#prediction" class="btn btn-warning btn-lg px-4 py-3 rounded-pill">
                            <i class="fas fa-magic me-2"></i>ì§€ê¸ˆ ì˜ˆì¸¡ ì‹œì‘í•˜ê¸°
                        </a>
                        <a href="#qr-scan" class="btn btn-outline-light btn-lg px-4 py-3 rounded-pill">
                            <i class="fas fa-qrcode me-2"></i>QR ë‹¹ì²¨í™•ì¸
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="hero-animation text-center">
                    <div class="lotto-ball-container" id="heroExampleNumbers">
                        <!-- ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” ì˜ˆì‹œ ë²ˆí˜¸ë“¤ -->
                        <div class="lotto-ball lotto-ball-1">1</div>
                        <div class="lotto-ball lotto-ball-2">7</div>
                        <div class="lotto-ball lotto-ball-3">13</div>
                        <div class="lotto-ball lotto-ball-4">25</div>
                        <div class="lotto-ball lotto-ball-5">31</div>
                        <div class="lotto-ball lotto-ball-6">42</div>
                    </div>
                    <p class="text-white-50 mt-3" id="exampleDescription">
                        AIê°€ ë¶„ì„í•œ ì˜ˆìƒë²ˆí˜¸ ì˜ˆì‹œ
                        <br><small class="text-warning">âœ¨ 30ì´ˆë§ˆë‹¤ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</small>
                    </p>
                    <div class="example-info mt-2" id="exampleInfo">
                        <!-- ì˜ˆì‹œ ë²ˆí˜¸ ë¶„ì„ ì •ë³´ê°€ í‘œì‹œë  ì˜ì—­ -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Quick Actions Section -->
<section class="py-4 bg-light">
    <div class="container">
        <div class="row g-3">
            <div class="col-md-3">
                <div class="quick-action-card" onclick="scrollToSection('prediction')">
                    <i class="fas fa-robot text-primary"></i>
                    <span>AI ì˜ˆì¸¡</span>
                </div>
            </div>
            <div class="col-md-3">
                <div class="quick-action-card" onclick="scrollToSection('qr-scan')">
                    <i class="fas fa-qrcode text-success"></i>
                    <span>QR ìŠ¤ìº”</span>
                </div>
            </div>
            <div class="col-md-3">
                <div class="quick-action-card" onclick="scrollToSection('my-numbers')">
                    <i class="fas fa-heart text-danger"></i>
                    <span>ë‚´ ë²ˆí˜¸</span>
                </div>
            </div>
            <div class="col-md-3">
                <div class="quick-action-card" onclick="scrollToSection('tools')">
                    <i class="fas fa-tools text-warning"></i>
                    <span>í¸ì˜ê¸°ëŠ¥</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- QR Scan Section -->
<section id="qr-scan" class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">ğŸ“± QRì½”ë“œ ë‹¹ì²¨í™•ì¸</h2>
            <p class="lead text-muted">ë¡œë˜ ìš©ì§€ì˜ QRì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬ ì¦‰ì‹œ ë‹¹ì²¨ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
        </div>
        
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card shadow-lg border-0">
                    <div class="card-header bg-gradient-success text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-camera me-2"></i>QRì½”ë“œ ìŠ¤ìº” ë‹¹ì²¨í™•ì¸
                        </h5>
                    </div>
                    <div class="card-body text-center">
                        <div id="qr-scanner-area" style="display: none;">
                            <video id="qr-video" width="100%" height="300" style="border-radius: 10px;"></video>
                            <canvas id="qr-canvas" style="display: none;"></canvas>
                        </div>
                        
                        <div id="qr-start-area">
                            <div class="qr-placeholder mb-4">
                                <i class="fas fa-qrcode fa-5x text-muted mb-3"></i>
                                <p class="text-muted">ì¹´ë©”ë¼ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë˜ ìš©ì§€ì˜ QRì½”ë“œë¥¼ ìŠ¤ìº”í•©ë‹ˆë‹¤</p>
                            </div>
                            <button id="start-qr-scan" class="btn btn-success btn-lg">
                                <i class="fas fa-camera me-2"></i>QR ìŠ¤ìº” ì‹œì‘
                            </button>
                        </div>
                        
                        <div id="qr-result" class="d-none">
                            <!-- QR ìŠ¤ìº” ê²°ê³¼ê°€ í‘œì‹œë  ì˜ì—­ -->
                        </div>
                        
                        <div class="mt-4">
                            <h6 class="text-muted">ë˜ëŠ” ë²ˆí˜¸ë¥¼ ì§ì ‘ ì…ë ¥</h6>
                            <div class="row g-2 mb-3">
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" placeholder="1" min="1" max="45" id="check-num1">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" placeholder="2" min="1" max="45" id="check-num2">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" placeholder="3" min="1" max="45" id="check-num3">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" placeholder="4" min="1" max="45" id="check-num4">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" placeholder="5" min="1" max="45" id="check-num5">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" placeholder="6" min="1" max="45" id="check-num6">
                                </div>
                            </div>
                            <button onclick="checkWinningManual()" class="btn btn-primary">
                                <i class="fas fa-check me-2"></i>ë‹¹ì²¨ í™•ì¸
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- My Numbers Section -->
<section id="my-numbers" class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">ğŸ’– ë‚´ ë²ˆí˜¸ ê´€ë¦¬</h2>
            <p class="lead text-muted">ì†Œì¤‘í•œ ë²ˆí˜¸ë“¤ì„ ì €ì¥í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”</p>
        </div>
        
        <div class="row">
            <div class="col-lg-6">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-gradient-primary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-plus me-2"></i>ìƒˆ ë²ˆí˜¸ ì €ì¥
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">ë¼ë²¨</label>
                            <input type="text" class="form-control" id="save-label" placeholder="ì˜ˆ: ìƒì¼ ë²ˆí˜¸, í–‰ìš´ ë²ˆí˜¸">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ë²ˆí˜¸ (1-45)</label>
                            <div class="row g-2">
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" min="1" max="45" id="save-num1">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" min="1" max="45" id="save-num2">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" min="1" max="45" id="save-num3">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" min="1" max="45" id="save-num4">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" min="1" max="45" id="save-num5">
                                </div>
                                <div class="col-2">
                                    <input type="number" class="form-control text-center" min="1" max="45" id="save-num6">
                                </div>
                            </div>
                        </div>
                        <button onclick="saveNumbers()" class="btn btn-primary w-100">
                            <i class="fas fa-save me-2"></i>ë²ˆí˜¸ ì €ì¥
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-gradient-secondary text-white d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <i class="fas fa-list me-2"></i>ì €ì¥ëœ ë²ˆí˜¸
                        </h6>
                        <button onclick="loadSavedNumbers()" class="btn btn-sm btn-outline-light">
                            <i class="fas fa-sync"></i>
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="saved-numbers-list" class="saved-numbers-container">
                            <div class="text-center text-muted py-4">
                                <i class="fas fa-inbox fa-2x mb-2"></i>
                                <p>ì €ì¥ëœ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                                <small>ì†Œì¤‘í•œ ë²ˆí˜¸ë“¤ì„ ì €ì¥í•´ë³´ì„¸ìš”!</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section id="features" class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">ğŸ¤– 5ê°€ì§€ AI ì˜ˆì¸¡ ëª¨ë¸</h2>
            <p class="lead text-muted">ê°ê¸° ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ì˜ˆì¸¡ì„ ì œê³µí•©ë‹ˆë‹¤</p>
        </div>
        
        <div class="row g-4">
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <h5>ë¹ˆë„ë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">ê³¼ê±° ë‹¹ì²¨ë²ˆí˜¸ ì¶œí˜„ ë¹ˆë„ë¥¼ ë¶„ì„í•˜ì—¬ ê°€ì¤‘ í™•ë¥ ë¡œ ì˜ˆì¸¡</p>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-trending-up"></i>
                    </div>
                    <h5>íŠ¸ë Œë“œë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">ìµœê·¼ ë‹¹ì²¨ íŒ¨í„´ê³¼ íŠ¸ë Œë“œë¥¼ ë¶„ì„í•˜ì—¬ ì‹œê¸°ë³„ ë³€í™” ë°˜ì˜</p>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <h5>íŒ¨í„´ë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">ë²ˆí˜¸ ì¡°í•© íŒ¨í„´ê³¼ ìˆ˜í•™ì  ê´€ê³„ë¥¼ ë¶„ì„í•˜ì—¬ ë³µí•© ì˜ˆì¸¡</p>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h5>í†µê³„ë¶„ì„ ëª¨ë¸</h5>
                    <p class="text-muted">ê³ ê¸‰ í†µê³„ ê¸°ë²•ê³¼ í™•ë¥  ì´ë¡ ì„ ì ìš©í•œ ìˆ˜í•™ì  ì˜ˆì¸¡</p>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h5>ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸</h5>
                    <p class="text-muted">ë”¥ëŸ¬ë‹ ì‹ ê²½ë§ê³¼ AI ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ ê³ ë„í™”ëœ ì˜ˆì¸¡</p>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <h5>ì¢…í•©ì¶”ì²œ ì‹œìŠ¤í…œ</h5>
                    <p class="text-muted">5ê°€ì§€ ëª¨ë¸ ê²°ê³¼ë¥¼ ì¢…í•©í•˜ì—¬ ìµœê³ ì˜ ì¶”ì²œë²ˆí˜¸ ì„ ë³„</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Prediction Section -->
<section id="prediction" class="py-5 bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="prediction-wrapper">
                    <div class="text-center mb-5">
                        <h2 class="display-5 fw-bold">ğŸ² AI ì˜ˆìƒë²ˆí˜¸ ìƒì„±</h2>
                        <p class="lead text-muted">ì›í•˜ëŠ” ë²ˆí˜¸ê°€ ìˆë‹¤ë©´ ì…ë ¥í•˜ì„¸ìš”. AIê°€ ë‚˜ë¨¸ì§€ë¥¼ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤!</p>
                    </div>
                    
                    <!-- User Input Section -->
                    <div class="card shadow-lg border-0 mb-4">
                        <div class="card-header bg-gradient-primary text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-heart me-2"></i>ì„ í˜¸í•˜ëŠ” ë²ˆí˜¸ ì…ë ¥ (ì„ íƒì‚¬í•­)
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="predictionForm">
                                <div class="mb-4">
                                    <label class="form-label fw-bold">
                                        ìƒì¼, ê¸°ë…ì¼ ë“± ì›í•˜ëŠ” ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (1~45)
                                    </label>
                                    <div class="number-input-grid">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸1" min="1" max="45" id="num1">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸2" min="1" max="45" id="num2">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸3" min="1" max="45" id="num3">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸4" min="1" max="45" id="num4">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸5" min="1" max="45" id="num5">
                                        <input type="number" class="form-control number-input" 
                                               placeholder="ë²ˆí˜¸6" min="1" max="45" id="num6">
                                    </div>
                                    <small class="text-muted">
                                        ğŸ’¡ ë¹„ì›Œë‘ë©´ AIê°€ ëª¨ë“  ë²ˆí˜¸ë¥¼ ìë™ìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤
                                    </small>
                                </div>
                                
                                <div class="text-center">
                                    <button type="submit" class="btn btn-gradient-primary btn-lg px-5 py-3 rounded-pill">
                                        <i class="fas fa-magic me-2"></i>
                                        <span class="btn-text">AI ì˜ˆìƒë²ˆí˜¸ ìƒì„±í•˜ê¸°</span>
                                        <div class="spinner-border spinner-border-sm ms-2 d-none" role="status"></div>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Loading Indicator -->
                    <div id="loadingSection" class="text-center py-5 d-none">
                        <div class="loading-animation">
                            <div class="spinner-grow text-primary" role="status"></div>
                            <div class="spinner-grow text-success" role="status"></div>
                            <div class="spinner-grow text-warning" role="status"></div>
                        </div>
                        <h4 class="mt-3">AI ëª¨ë¸ì´ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</h4>
                        <p class="text-muted">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”. ìµœì ì˜ ë²ˆí˜¸ë¥¼ ì°¾ê³  ìˆì–´ìš”! ğŸ¤–</p>
                    </div>
                    
                    <!-- Results Section -->
                    <div id="resultsSection" class="d-none">
                        <!-- Top Recommendations -->
                        <div class="card shadow-lg border-0 mb-4">
                            <div class="card-header bg-gradient-success text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-crown me-2"></i>AI ìµœê³  ì¶”ì²œ ë²ˆí˜¸ TOP 5
                                </h5>
                            </div>
                            <div class="card-body">
                                <div id="topRecommendations" class="row g-3">
                                    <!-- Dynamic content -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Model Results -->
                        <div class="card shadow-lg border-0">
                            <div class="card-header bg-gradient-info text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-robot me-2"></i>ëª¨ë¸ë³„ ìƒì„¸ ë¶„ì„ ê²°ê³¼
                                </h5>
                            </div>
                            <div class="card-body">
                                <div id="modelResults">
                                    <!-- Dynamic content -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Enhanced Stats Section -->
<section id="stats" class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">ğŸ“Š ê³ ê¸‰ í†µê³„ ë¶„ì„</h2>
            <p class="lead text-muted">ê³¼ê±° ë‹¹ì²¨ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹¤ì‹œê°„ ë¶„ì„ ê²°ê³¼</p>
        </div>
        
        <!-- Basic Stats -->
        <div class="row g-4 mb-5">
            <div class="col-lg-6">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-danger text-white">
                        <h6 class="mb-0"><i class="fas fa-fire me-2"></i>í•« ë„˜ë²„ (ìì£¼ ë‚˜ì˜¤ëŠ” ë²ˆí˜¸)</h6>
                    </div>
                    <div class="card-body">
                        <div id="hotNumbers" class="number-display">
                            <!-- Dynamic content -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0"><i class="fas fa-snowflake me-2"></i>ì½œë“œ ë„˜ë²„ (ì˜ ì•ˆ ë‚˜ì˜¤ëŠ” ë²ˆí˜¸)</h6>
                    </div>
                    <div class="card-body">
                        <div id="coldNumbers" class="number-display">
                            <!-- Dynamic content -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Analysis -->
        <div class="row g-4">
            <div class="col-lg-4">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-warning text-dark">
                        <h6 class="mb-0"><i class="fas fa-repeat me-2"></i>ì´ì›”ìˆ˜ ë¶„ì„</h6>
                    </div>
                    <div class="card-body">
                        <div id="carryOverAnalysis">
                            <div class="text-center text-muted py-3">
                                <div class="spinner-border spinner-border-sm"></div>
                                <p class="mt-2 mb-0">ë¶„ì„ ì¤‘...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-success text-white">
                        <h6 class="mb-0"><i class="fas fa-handshake me-2"></i>ê¶í•©ìˆ˜ ë¶„ì„</h6>
                    </div>
                    <div class="card-body">
                        <div id="companionAnalysis">
                            <div class="text-center text-muted py-3">
                                <div class="spinner-border spinner-border-sm"></div>
                                <p class="mt-2 mb-0">ë¶„ì„ ì¤‘...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-info text-white">
                        <h6 class="mb-0"><i class="fas fa-chart-line me-2"></i>íŒ¨í„´ ë¶„ì„</h6>
                    </div>
                    <div class="card-body">
                        <div id="patternAnalysis">
                            <div class="text-center text-muted py-3">
                                <div class="spinner-border spinner-border-sm"></div>
                                <p class="mt-2 mb-0">ë¶„ì„ ì¤‘...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Tools Section -->
<section id="tools" class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">ğŸ› ï¸ í¸ì˜ê¸°ëŠ¥</h2>
            <p class="lead text-muted">ë¡œë˜ë¥¼ ë” ìŠ¤ë§ˆíŠ¸í•˜ê²Œ ì¦ê¸°ëŠ” ë„êµ¬ë“¤</p>
        </div>
        
        <div class="row g-4">
            <!-- Tax Calculator -->
            <div class="col-lg-4">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-gradient-warning text-dark">
                        <h6 class="mb-0">
                            <i class="fas fa-calculator me-2"></i>ì„¸ê¸ˆ ê³„ì‚°ê¸°
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">ë‹¹ì²¨ê¸ˆì•¡</label>
                            <input type="number" class="form-control" id="tax-amount" placeholder="ë‹¹ì²¨ê¸ˆì•¡ ì…ë ¥">
                        </div>
                        <button onclick="calculateTax()" class="btn btn-warning w-100 mb-3">
                            <i class="fas fa-calculator me-2"></i>ì„¸ê¸ˆ ê³„ì‚°
                        </button>
                        <div id="tax-result" class="tax-result d-none">
                            <!-- ì„¸ê¸ˆ ê³„ì‚° ê²°ê³¼ -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Simulation -->
            <div class="col-lg-4">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-gradient-info text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-chart-bar me-2"></i>ë‹¹ì²¨ ì‹œë®¬ë ˆì´ì…˜
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">ì‹œë®¬ë ˆì´ì…˜ íšŸìˆ˜</label>
                            <select class="form-select" id="sim-rounds">
                                <option value="1000">1,000íšŒ</option>
                                <option value="5000">5,000íšŒ</option>
                                <option value="10000">10,000íšŒ</option>
                            </select>
                        </div>
                        <button onclick="openSimulationModal()" class="btn btn-info w-100 mb-3">
                            <i class="fas fa-play me-2"></i>ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
                        </button>
                        <small class="text-muted">íŠ¹ì • ë²ˆí˜¸ë¡œ ëª‡ ë²ˆì´ë‚˜ ë‹¹ì²¨ë ì§€ ì‹œë®¬ë ˆì´ì…˜í•´ë³´ì„¸ìš”</small>
                    </div>
                </div>
            </div>
            
            <!-- Store Locator -->
            <div class="col-lg-4">
                <div class="card shadow border-0 h-100">
                    <div class="card-header bg-gradient-success text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-map-marker-alt me-2"></i>íŒë§¤ì  ì°¾ê¸°
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">ì§€ì—­</label>
                            <input type="text" class="form-control" id="store-location" placeholder="ì§€ì—­ëª… ì…ë ¥">
                        </div>
                        <button onclick="findLotteryStores()" class="btn btn-success w-100 mb-3">
                            <i class="fas fa-search me-2"></i>íŒë§¤ì  ê²€ìƒ‰
                        </button>
                        <div id="store-results" class="store-results">
                            <!-- íŒë§¤ì  ê²€ìƒ‰ ê²°ê³¼ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- About Section -->
<section id="about" class="py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h2 class="display-5 fw-bold mb-4">ğŸ¯ ì™œ LottoPro AI v2.0ì¸ê°€ìš”?</h2>
                <div class="about-features">
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>100% ë¬´ë£Œ ì„œë¹„ìŠ¤</h6>
                            <p class="text-muted mb-0">ê³ í’ˆì§ˆ AI ì˜ˆì¸¡ì„ ì™„ì „ ë¬´ë£Œë¡œ ì œê³µí•©ë‹ˆë‹¤</p>
                        </div>
                    </div>
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>15ê°€ì§€ í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥</h6>
                            <p class="text-muted mb-0">QRìŠ¤ìº”, ë²ˆí˜¸ì €ì¥, ì‹œë®¬ë ˆì´ì…˜ ë“± ëª¨ë“  ê¸°ëŠ¥ì´ ë¬´ë£Œ</p>
                        </div>
                    </div>
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>5ê°€ì§€ ë…ìì  AI ëª¨ë¸</h6>
                            <p class="text-muted mb-0">ë‹¤ì–‘í•œ ë¶„ì„ ë°©ì‹ìœ¼ë¡œ ì •í™•ë„ë¥¼ ë†’ì˜€ìŠµë‹ˆë‹¤</p>
                        </div>
                    </div>
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>ê°œì¸í™” ì¶”ì²œ ì‹œìŠ¤í…œ</h6>
                            <p class="text-muted mb-0">ì‚¬ìš©ìì˜ ì„ í˜¸ë²ˆí˜¸ë¥¼ ë°˜ì˜í•œ ë§ì¶¤ ì¶”ì²œ</p>
                        </div>
                    </div>
                    <div class="about-feature-item">
                        <i class="fas fa-check-circle text-success me-3"></i>
                        <div>
                            <h6>ì‹¤ì‹œê°„ ë°ì´í„° ë¶„ì„</h6>
                            <p class="text-muted mb-0">ìµœì‹  ë‹¹ì²¨ íŒ¨í„´ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°˜ì˜í•©ë‹ˆë‹¤</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="about-image text-center">
                    <div class="ai-brain-animation">
                        <i class="fas fa-brain fa-8x text-primary opacity-75"></i>
                        <div class="brain-pulse"></div>
                    </div>
                    <p class="mt-3 text-muted">AIê°€ 24ì‹œê°„ ë°ì´í„°ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Simulation Modal -->
<div class="modal fade" id="simulationModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-gradient-info text-white">
                <h5 class="modal-title">
                    <i class="fas fa-chart-bar me-2"></i>ë‹¹ì²¨ ì‹œë®¬ë ˆì´ì…˜
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-4">
                    <h6>ì‹œë®¬ë ˆì´ì…˜í•  ë²ˆí˜¸ ì„ íƒ</h6>
                    <div class="row g-2">
                        <div class="col-2">
                            <input type="number" class="form-control text-center" min="1" max="45" id="sim-num1">
                        </div>
                        <div class="col-2">
                            <input type="number" class="form-control text-center" min="1" max="45" id="sim-num2">
                        </div>
                        <div class="col-2">
                            <input type="number" class="form-control text-center" min="1" max="45" id="sim-num3">
                        </div>
                        <div class="col-2">
                            <input type="number" class="form-control text-center" min="1" max="45" id="sim-num4">
                        </div>
                        <div class="col-2">
                            <input type="number" class="form-control text-center" min="1" max="45" id="sim-num5">
                        </div>
                        <div class="col-2">
                            <input type="number" class="form-control text-center" min="1" max="45" id="sim-num6">
                        </div>
                    </div>
                </div>
                
                <div class="text-center mb-4">
                    <button onclick="runSimulation()" class="btn btn-info btn-lg">
                        <i class="fas fa-play me-2"></i>ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘
                    </button>
                </div>
                
                <div id="simulation-results" class="d-none">
                    <!-- ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ê°€ í‘œì‹œë  ì˜ì—­ -->
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
// Enhanced page initialization
document.addEventListener('DOMContentLoaded', function() {
    loadStatistics();
    loadAdvancedAnalysis();
    loadSavedNumbers();
    
    // ì‹¤ì‹œê°„ ì˜ˆì‹œë²ˆí˜¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
    if (window.lottoPro) {
        window.lottoPro.initializeHeroExampleNumbers();
    } else {
        setTimeout(() => {
            if (window.lottoPro) {
                window.lottoPro.initializeHeroExampleNumbers();
            }
        }, 1000);
    }
});

// Enhanced statistics loading
async function loadStatistics() {
    try {
        const response = await fetch('/api/stats');
        const data = await response.json();
        
        if (data.hot_numbers && data.cold_numbers) {
            displayHotNumbers(data.hot_numbers);
            displayColdNumbers(data.cold_numbers);
        }
    } catch (error) {
        console.error('í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
    }
}

async function loadAdvancedAnalysis() {
    try {
        const response = await fetch('/api/stats');
        const data = await response.json();
        
        // ì´ì›”ìˆ˜ ë¶„ì„ í‘œì‹œ
        if (data.carry_over_analysis) {
            displayCarryOverAnalysis(data.carry_over_analysis);
        }
        
        // ê¶í•©ìˆ˜ ë¶„ì„ í‘œì‹œ
        if (data.companion_analysis) {
            displayCompanionAnalysis(data.companion_analysis);
        }
        
        // íŒ¨í„´ ë¶„ì„ í‘œì‹œ
        if (data.pattern_analysis) {
            displayPatternAnalysis(data.pattern_analysis);
        }
    } catch (error) {
        console.error('ê³ ê¸‰ ë¶„ì„ ë¡œë“œ ì‹¤íŒ¨:', error);
    }
}

function displayHotNumbers(hotNumbers) {
    const container = document.getElementById('hotNumbers');
    container.innerHTML = hotNumbers.slice(0, 8).map(([num, freq]) => 
        `<div class="lotto-ball hot-number" title="${freq}íšŒ ì¶œí˜„">${num}</div>`
    ).join('');
}

function displayColdNumbers(coldNumbers) {
    const container = document.getElementById('coldNumbers');
    container.innerHTML = coldNumbers.slice(0, 8).map(([num, freq]) => 
        `<div class="lotto-ball cold-number" title="${freq}íšŒ ì¶œí˜„">${num}</div>`
    ).join('');
}

function displayCarryOverAnalysis(data) {
    const container = document.getElementById('carryOverAnalysis');
    if (data && data.length > 0) {
        container.innerHTML = data.slice(0, 5).map(item => `
            <div class="carry-over-item mb-2">
                <small class="text-muted">${item.round}íšŒì°¨</small>
                <div class="d-flex gap-1">
                    ${item.carry_over_numbers.map(num => 
                        `<span class="badge bg-warning text-dark">${num}</span>`
                    ).join('')}
                </div>
                <small>ì´ì›”: ${item.count}ê°œ</small>
            </div>
        `).join('');
    } else {
        container.innerHTML = '<p class="text-muted text-center">ë¶„ì„ ë°ì´í„° ì—†ìŒ</p>';
    }
}

function displayCompanionAnalysis(data) {
    const container = document.getElementById('companionAnalysis');
    if (data && data.length > 0) {
        container.innerHTML = data.slice(0, 5).map(([pair, count]) => `
            <div class="companion-item mb-2">
                <div class="d-flex gap-1 align-items-center">
                    <span class="badge bg-success">${pair[0]}</span>
                    <i class="fas fa-plus text-muted"></i>
                    <span class="badge bg-success">${pair[1]}</span>
                    <small class="text-muted ms-2">${count}íšŒ</small>
                </div>
            </div>
        `).join('');
    } else {
        container.innerHTML = '<p class="text-muted text-center">ë¶„ì„ ë°ì´í„° ì—†ìŒ</p>';
    }
}

function displayPatternAnalysis(data) {
    const container = document.getElementById('patternAnalysis');
    if (data && Object.keys(data).length > 0) {
        const avgSum = data.sum_distribution ? 
            Math.round(data.sum_distribution.reduce((a, b) => a + b, 0) / data.sum_distribution.length) : 0;
        const avgRange = data.range_distribution ? 
            Math.round(data.range_distribution.reduce((a, b) => a + b, 0) / data.range_distribution.length) : 0;
        
        container.innerHTML = `
            <div class="pattern-stats">
                <div class="mb-2">
                    <small class="text-muted">í‰ê·  í•©ê³„</small>
                    <div class="fw-bold">${avgSum}</div>
                </div>
                <div class="mb-2">
                    <small class="text-muted">í‰ê·  ë²”ìœ„</small>
                    <div class="fw-bold">${avgRange}</div>
                </div>
                <div class="mb-2">
                    <small class="text-muted">ì—°ì†ë²ˆí˜¸ ì¶œí˜„</small>
                    <div class="fw-bold">${data.consecutive_count ? data.consecutive_count.filter(x => x > 0).length : 0}íšŒ</div>
                </div>
            </div>
        `;
    } else {
        container.innerHTML = '<p class="text-muted text-center">ë¶„ì„ ë°ì´í„° ì—†ìŒ</p>';
    }
}

// QR Scanner functions
document.getElementById('start-qr-scan')?.addEventListener('click', function() {
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        document.getElementById('qr-start-area').style.display = 'none';
        document.getElementById('qr-scanner-area').style.display = 'block';
        
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(function(stream) {
                const video = document.getElementById('qr-video');
                video.srcObject = stream;
                video.play();
                showToast('QR ìŠ¤ìº” ì¤€ë¹„ ì™„ë£Œ! ë¡œë˜ ìš©ì§€ë¥¼ ì¹´ë©”ë¼ì— ëŒ€ì£¼ì„¸ìš”.', 'info');
            })
            .catch(function(err) {
                console.error('ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨:', err);
                showToast('ì¹´ë©”ë¼ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ë™ ì…ë ¥ì„ ì´ìš©í•´ì£¼ì„¸ìš”.', 'error');
                document.getElementById('qr-start-area').style.display = 'block';
                document.getElementById('qr-scanner-area').style.display = 'none';
            });
    } else {
        showToast('ì´ ë¸Œë¼ìš°ì €ëŠ” ì¹´ë©”ë¼ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
    }
});

// Number saving functions
async function saveNumbers() {
    const label = document.getElementById('save-label').value || `ì €ì¥ëœ ë²ˆí˜¸ ${new Date().toLocaleString()}`;
    const numbers = [];
    
    for (let i = 1; i <= 6; i++) {
        const input = document.getElementById(`save-num${i}`);
        if (input.value) {
            const num = parseInt(input.value);
            if (num >= 1 && num <= 45) {
                numbers.push(num);
            }
        }
    }
    
    if (numbers.length !== 6) {
        showToast('6ê°œì˜ ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
        return;
    }
    
    if (new Set(numbers).size !== 6) {
        showToast('ì¤‘ë³µëœ ë²ˆí˜¸ê°€ ìˆìŠµë‹ˆë‹¤.', 'warning');
        return;
    }
    
    try {
        const response = await fetch('/api/save-numbers', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                numbers: numbers.sort((a, b) => a - b),
                label: label
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            showToast('ë²ˆí˜¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('save-label').value = '';
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`save-num${i}`).value = '';
            }
            
            // ì €ì¥ëœ ë²ˆí˜¸ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            loadSavedNumbers();
        } else {
            showToast(data.error || 'ë²ˆí˜¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    } catch (error) {
        console.error('ë²ˆí˜¸ ì €ì¥ ì‹¤íŒ¨:', error);
        showToast('ë²ˆí˜¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
    }
}

async function loadSavedNumbers() {
    try {
        const response = await fetch('/api/saved-numbers');
        const data = await response.json();
        
        const container = document.getElementById('saved-numbers-list');
        
        if (data.success && data.saved_numbers.length > 0) {
            container.innerHTML = data.saved_numbers.map(item => `
                <div class="saved-number-item mb-3 p-3 border rounded">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h6 class="mb-0">${item.label}</h6>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-primary" onclick="checkSavedNumber('${item.id}', [${item.numbers.join(',')}])">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="btn btn-outline-danger" onclick="deleteSavedNumber('${item.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="number-display mb-2">
                        ${item.numbers.map(num => `<div class="lotto-ball lotto-ball-${Math.ceil(num/9)}">${num}</div>`).join('')}
                    </div>
                    <small class="text-muted">${new Date(item.saved_at).toLocaleString()}</small>
                </div>
            `).join('');
        } else {
            container.innerHTML = `
                <div class="text-center text-muted py-4">
                    <i class="fas fa-inbox fa-2x mb-2"></i>
                    <p>ì €ì¥ëœ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                    <small>ì†Œì¤‘í•œ ë²ˆí˜¸ë“¤ì„ ì €ì¥í•´ë³´ì„¸ìš”!</small>
                </div>
            `;
        }
    } catch (error) {
        console.error('ì €ì¥ëœ ë²ˆí˜¸ ë¡œë“œ ì‹¤íŒ¨:', error);
    }
}

async function deleteSavedNumber(id) {
    if (!confirm('ì´ ë²ˆí˜¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        return;
    }
    
    try {
        const response = await fetch('/api/delete-saved-number', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ id: id })
        });
        
        const data = await response.json();
        
        if (data.success) {
            showToast('ë²ˆí˜¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            loadSavedNumbers();
        } else {
            showToast(data.error || 'ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    } catch (error) {
        console.error('ë²ˆí˜¸ ì‚­ì œ ì‹¤íŒ¨:', error);
        showToast('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
    }
}

// Winning check functions
async function checkWinningManual() {
    const numbers = [];
    
    for (let i = 1; i <= 6; i++) {
        const input = document.getElementById(`check-num${i}`);
        if (input.value) {
            const num = parseInt(input.value);
            if (num >= 1 && num <= 45) {
                numbers.push(num);
            }
        }
    }
    
    if (numbers.length !== 6) {
        showToast('6ê°œì˜ ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
        return;
    }
    
    await checkWinning(numbers);
}

async function checkSavedNumber(id, numbers) {
    await checkWinning(numbers);
}

async function checkWinning(numbers) {
    try {
        const response = await fetch('/api/check-winning', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ numbers: numbers })
        });
        
        const data = await response.json();
        
        if (data.success) {
            displayWinningResult(data);
        } else {
            showToast(data.error || 'ë‹¹ì²¨ í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    } catch (error) {
        console.error('ë‹¹ì²¨ í™•ì¸ ì‹¤íŒ¨:', error);
        showToast('ë‹¹ì²¨ í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
    }
}

function displayWinningResult(data) {
    const resultContainer = document.getElementById('qr-result');
    
    let resultClass = 'alert-success';
    let resultIcon = 'fas fa-trophy';
    
    if (data.prize === 'ë‚™ì²¨') {
        resultClass = 'alert-secondary';
        resultIcon = 'fas fa-times-circle';
    } else if (data.prize === '1ë“±' || data.prize === '2ë“±') {
        resultClass = 'alert-warning';
        resultIcon = 'fas fa-crown';
    }
    
    resultContainer.innerHTML = `
        <div class="alert ${resultClass}">
            <div class="text-center">
                <i class="${resultIcon} fa-3x mb-3"></i>
                <h4>${data.prize}</h4>
                <h5 class="text-primary">${data.prize_money}</h5>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <h6>ë‚´ ë²ˆí˜¸</h6>
                        <div class="number-display justify-content-center">
                            ${data.user_numbers.map(num => 
                                `<div class="lotto-ball lotto-ball-${Math.ceil(num/9)}">${num}</div>`
                            ).join('')}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6>ë‹¹ì²¨ë²ˆí˜¸ (${data.round}íšŒì°¨)</h6>
                        <div class="number-display justify-content-center">
                            ${data.winning_numbers.map(num => 
                                `<div class="lotto-ball ${data.user_numbers.includes(num) ? 'matched' : ''}">${num}</div>`
                            ).join('')}
                            <div class="lotto-ball bonus-ball">${data.bonus_number}</div>
                        </div>
                        <small class="text-muted">ë§ˆì§€ë§‰ì€ ë³´ë„ˆìŠ¤ë²ˆí˜¸</small>
                    </div>
                </div>
                
                <div class="mt-3">
                    <strong>ì¼ì¹˜í•˜ëŠ” ë²ˆí˜¸: ${data.matches}ê°œ</strong>
                    ${data.bonus_match ? ' + ë³´ë„ˆìŠ¤ ì¼ì¹˜' : ''}
                </div>
            </div>
        </div>
    `;
    
    resultContainer.classList.remove('d-none');
    resultContainer.scrollIntoView({ behavior: 'smooth' });
}

// Tool functions
async function calculateTax() {
    const amount = parseInt(document.getElementById('tax-amount').value);
    
    if (!amount || amount <= 0) {
        showToast('ì˜¬ë°”ë¥¸ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
        return;
    }
    
    try {
        const response = await fetch('/api/tax-calculator', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ prize_amount: amount })
        });
        
        const data = await response.json();
        
        if (data.success) {
            const resultContainer = document.getElementById('tax-result');
            resultContainer.innerHTML = `
                <div class="tax-breakdown">
                    <div class="row text-center">
                        <div class="col-4">
                            <div class="tax-item">
                                <div class="h6 text-primary">${data.prize_amount.toLocaleString()}ì›</div>
                                <small class="text-muted">ë‹¹ì²¨ê¸ˆ</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="tax-item">
                                <div class="h6 text-danger">-${data.tax_amount.toLocaleString()}ì›</div>
                                <small class="text-muted">ì„¸ê¸ˆ (${data.tax_rate}%)</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="tax-item">
                                <div class="h6 text-success">${data.net_amount.toLocaleString()}ì›</div>
                                <small class="text-muted">ì‹¤ìˆ˜ë ¹ì•¡</small>
                            </div>
                        </div>
                    </div>
                    <small class="text-muted d-block text-center mt-2">
                        â€» 5ë§Œì› ì´í•˜ëŠ” ë¹„ê³¼ì„¸
                    </small>
                </div>
            `;
            resultContainer.classList.remove('d-none');
        } else {
            showToast(data.error || 'ì„¸ê¸ˆ ê³„ì‚°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    } catch (error) {
        console.error('ì„¸ê¸ˆ ê³„ì‚° ì‹¤íŒ¨:', error);
        showToast('ì„¸ê¸ˆ ê³„ì‚°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
    }
}

function openSimulationModal() {
    const modal = new bootstrap.Modal(document.getElementById('simulationModal'));
    modal.show();
}

async function runSimulation() {
    const numbers = [];
    
    for (let i = 1; i <= 6; i++) {
        const input = document.getElementById(`sim-num${i}`);
        if (input.value) {
            const num = parseInt(input.value);
            if (num >= 1 && num <= 45) {
                numbers.push(num);
            }
        }
    }
    
    if (numbers.length !== 6) {
        showToast('6ê°œì˜ ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
        return;
    }
    
    const rounds = parseInt(document.getElementById('sim-rounds').value);
    
    try {
        showToast('ì‹œë®¬ë ˆì´ì…˜ì„ ì‹¤í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
        
        const response = await fetch('/api/simulation', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                numbers: numbers,
                rounds: rounds
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            displaySimulationResults(data);
        } else {
            showToast(data.error || 'ì‹œë®¬ë ˆì´ì…˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    } catch (error) {
        console.error('ì‹œë®¬ë ˆì´ì…˜ ì‹¤íŒ¨:', error);
        showToast('ì‹œë®¬ë ˆì´ì…˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
    }
}

function displaySimulationResults(data) {
    const container = document.getElementById('simulation-results');
    
    container.innerHTML = `
        <div class="simulation-summary">
            <h6 class="text-center mb-4">ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼</h6>
            
            <div class="row text-center mb-4">
                <div class="col-md-3">
                    <div class="sim-stat">
                        <div class="h5 text-primary">${data.total_rounds.toLocaleString()}íšŒ</div>
                        <small class="text-muted">ì´ ì‹œí–‰</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="sim-stat">
                        <div class="h5 text-danger">-${data.total_cost.toLocaleString()}ì›</div>
                        <small class="text-muted">ì´ êµ¬ë§¤ë¹„ìš©</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="sim-stat">
                        <div class="h5 text-success">+${data.total_prize.toLocaleString()}ì›</div>
                        <small class="text-muted">ì´ ìƒê¸ˆ</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="sim-stat">
                        <div class="h5 ${data.profit_rate >= 0 ? 'text-success' : 'text-danger'}">${data.profit_rate}%</div>
                        <small class="text-muted">ìˆ˜ìµë¥ </small>
                    </div>
                </div>
            </div>
            
            <div class="prize-breakdown">
                <h6>ë“±ìˆ˜ë³„ ë‹¹ì²¨ ê²°ê³¼</h6>
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>ë“±ìˆ˜</th>
                                <th>ë‹¹ì²¨íšŸìˆ˜</th>
                                <th>ë‹¹ì²¨í™•ë¥ </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-warning">
                                <td>1ë“±</td>
                                <td>${data.results['1ë“±']}íšŒ</td>
                                <td>${((data.results['1ë“±'] / data.total_rounds) * 100).toFixed(6)}%</td>
                            </tr>
                            <tr class="table-info">
                                <td>2ë“±</td>
                                <td>${data.results['2ë“±']}íšŒ</td>
                                <td>${((data.results['2ë“±'] / data.total_rounds) * 100).toFixed(4)}%</td>
                            </tr>
                            <tr class="table-success">
                                <td>3ë“±</td>
                                <td>${data.results['3ë“±']}íšŒ</td>
                                <td>${((data.results['3ë“±'] / data.total_rounds) * 100).toFixed(3)}%</td>
                            </tr>
                            <tr>
                                <td>4ë“±</td>
                                <td>${data.results['4ë“±']}íšŒ</td>
                                <td>${((data.results['4ë“±'] / data.total_rounds) * 100).toFixed(2)}%</td>
                            </tr>
                            <tr>
                                <td>5ë“±</td>
                                <td>${data.results['5ë“±']}íšŒ</td>
                                <td>${((data.results['5ë“±'] / data.total_rounds) * 100).toFixed(2)}%</td>
                            </tr>
                            <tr class="table-light">
                                <td>ë‚™ì²¨</td>
                                <td>${data.results['ë‚™ì²¨']}íšŒ</td>
                                <td>${((data.results['ë‚™ì²¨'] / data.total_rounds) * 100).toFixed(1)}%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    `;
    
    container.classList.remove('d-none');
    showToast('ì‹œë®¬ë ˆì´ì…˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
}

async function findLotteryStores() {
    const location = document.getElementById('store-location').value;
    
    if (!location) {
        showToast('ì§€ì—­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
        return;
    }
    
    try {
        const response = await fetch('/api/lottery-stores');
        const data = await response.json();
        
        if (data.success) {
            const container = document.getElementById('store-results');
            container.innerHTML = data.stores.slice(0, 5).map(store => `
                <div class="store-item mb-3 p-2 border rounded">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="mb-1">${store.name}</h6>
                            <small class="text-muted">${store.address}</small>
                            <div class="mt-1">
                                <span class="badge bg-warning text-dark">1ë“± ${store.first_wins}íšŒ</span>
                            </div>
                        </div>
                        <div class="text-end">
                            <small class="text-muted">${store.phone}</small>
                            ${store.distance ? `<div><small class="text-primary">${store.distance}km</small></div>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        } else {
            showToast(data.error || 'íŒë§¤ì  ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    } catch (error) {
        console.error('íŒë§¤ì  ê²€ìƒ‰ ì‹¤íŒ¨:', error);
        showToast('íŒë§¤ì  ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
    }
}

// Utility functions
function scrollToSection(sectionId) {
    document.getElementById(sectionId)?.scrollIntoView({ behavior: 'smooth' });
}

function showToast(message, type = 'info') {
    // ì´ë¯¸ lottoProì— êµ¬í˜„ëœ showToast ì‚¬ìš©
    if (window.lottoPro && window.lottoPro.showToast) {
        window.lottoPro.showToast(message, type);
    } else {
        // í´ë°±
        alert(message);
    }
}
</script>
{% endblock %}
